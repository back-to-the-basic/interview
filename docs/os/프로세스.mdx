import Image from '@site/src/components/Image';

# 프로세스

## Concept

운영체제에서 모든 CPU 활동을 무엇이라고 부를 것인가에 대한 질문이 있다. 초창기 컴퓨터는
작업을 실행하는 일괄처리 시스템이었고, 사용자 프로그램 또는 태스크(task)를 실행하는 시분할
시스템이 뒤를 이었다. 단일 사용자 시스템에서도 사용자는 워드 프로세서, 웹 브라우저 및
전자 메일 패키지와 같은 여러 프로그램을 한 번에 실행할 수 있다. 또한 멀티 태스킹을
지원하지 않는 임베디드 장치에서와 같이 컴퓨터가 한 번에 하나의 프로그램만 실행할 수 있더라도
운영체제는 메모리 관리와 같은 자체 프로그램된 내부 활동을 지원해야 할 수도 있다.
여러 측면에서 이런 모든 활동은 유사하므로 이러한 모든 활동을 프로세스라고 부를 수 있다.

**프로세스는 실행 중인 프로그램이다..** 프로세스의 현재 활동의 상태는 프로그램 카운터 값과
프로세서 레지스터의 내용으로 나타낸다.

<Image
  src="https://user-images.githubusercontent.com/63354527/217720856-013fa9d7-5335-456a-a2f5-84a0900572b4.png"
  referenceLink="https://user-images.githubusercontent.com/63354527/217720856-013fa9d7-5335-456a-a2f5-84a0900572b4.png"
  description="프로세스 메모리 배치"
  height="300px"
/>

<br />

프로세스는 일반적으로 네개의 섹션으로 구성된다.

- 텍스트 섹션: 실행 코드
- 데이터 섹션: 전역 변수
- 힙 섹션: 프로그램 실행 중에 동적으로 할당되는 메모리
- 스택 섹션: 함수를 호출할 때 임시 데이터 저장장소(예: 함수 매개변수, 복귀 주소 및 지역 변수)

텍스트 및 데이터 섹션의 크기는 고정되기 때문에 프로그램 실행 시간 동안 크기가 변하지 않는다.
그러나 스택 및 힙 섹션은 호출될 때마다 함수 매개변수, 지역 변수 및 복귀 주소를 포함하는 활성화
레코드(activation record)가 스택에 푸쉬된다. 함수에서 제어가 되돌아오면 스택에서 활성화
레코드가 팝 된다. 마찬가지로 메모리가 동적으로 할당됨에 따라 힙이 커지고 메모리가 시스템에
반환되면 축소된다. 스택 및 힙 섹션이 서로의 방향으로 커지더라도 운영체제는 서로 겹치지 않도록
해야 한다.

## 프로세스 상태

컴퓨터를 사용할 때 여러 프로세스들이 빠르게 번갈아 가면서 실행됩니다.  
그 과정에서 하나의 프로세스는 여러 상태를 거치며 실행됩니다. 그리고 운영체제는 프로세스의 상태를
PCB를 통해 인식하고 관리합니다.  
프로세스 상태를 표현하는 방식은 운영체제마다 조금씩 차이가 있지만, 프로세스가 가질 수 있는 대표적인 상태는 `생성`, `준비`, `실행`, `대기`, `종료` 상태가 있습니다.

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fbp3Mzr%2FbtrUh4mQvJo%2Fsm9kK4Z949elUg9KgARzk1%2Fimg.png)

위와 같은 도표를 프로세스 상태 다이어그램(process state diagram)이라고 합니다.

## 생성 상태

프로세스를 생성 중인 상태를 생성 상태(new)라고 합니다. 이제 막 메모리에 적재되어 PCB를 할당받은 상태입니다.
생성 상태를 거쳐 실행할 준비가 완료된 프로세스는 곧바로 실행되지 않고 준비 상태가 되어 CPU의 할당을 기다립니다.

## 준비 상태

준비 상태(ready)는 당장이라도 CPU를 할당받아 실행할 수 있지만, 아직 자신의 차례가 아니기에 기다리고 있는 상태입니다.
준비 상태 프로세스는 차례가 되면 CPU를 할당받아 실행 상태가 됩니다.

:::tip
준비 상태인 프로세스가 실행 상태로 전환되는 것을 디스패치(dispatch)라고 합니다.
:::

## 실행 상태

실행 상태(running)은 CPU를 할당받아 실행 중인 상태를 의미합니다.
실행 상태인 프로세스는 일정 시간동안만 CPU를 사용할 수 있습니다. 이 때 프로세스가 할당된 시간을 모두 사용한다면(타이머 인터럽트가 발생하면) 다시 준비 상태가 되고,
실행 도중 입출력장치를 사용하여 입출력장치의 작업이 끝날 때까지 기다려야 한다면 대기 상태가 됩니다.

## 대기 상태

프로세스는 실행 도중 입출장치를 사용하는 경우가 있습니다. 입출력 작업은 CPU에 비해 처리 속도가 느리기에, 입출력 작업을 요청한 프로세스는 입출력 장치가 입출력을
끝낼 때 까지(입출력 완료 인터럽트를 받을 때까지) 기다려야 합니다. 이렇게 입출력장치의 작업을 기다리는 상태를 대기 상태(blocked)라고 합니다. 입출력 작업이
완료되면 해당 프로세스는 다시 준비 상태로 CPU 할당을 기다립니다.

:::tip
프로세스가 대기 상태가 되는 이유에 입출력 작업만 있는 것은 아닙니다. 조금 더 일반적으로 표현하자면 특정 이벤트가 일어나길 기다릴 때 프로세스는 대기 상태가 됩니다.
다만, 프로세스가 대기 상태가 되는 대부분의 원인이 입출력 작업이기 때문에 '프로세스가 입출력 작업을 하면 대기 상태가 된다'고 생각해도 무방합니다.
:::

## 종료 상태

종료 상태(terminated)는 프로세스가 종료된 상태입니다. 프로세스가 종료되면 운영체제는 PCB와 프로세스가 사용한 메모리를 정리합니다.

## Referecne

- Operating Systems Concept
