# 가상 메모리

다중 프로그래밍을 실현하기 위해서는 많은 프로세스들을 동시에 메모리에 올려두어야 한다.
가상 메모리는 프로세스 전체가 메모리 내에 올라오지 않더라도 실행이 가능하도록 하는 기법이며,
프로그램이 물리 메모리보다 커도 된다는 주요 장점이 있다.

가상 메모리는 메모리가 실제 메모리보다 많아 보이게 하는 기술로, 어떤 프로세스가 실행될 때
메모리에 해당 프로세스 전체가 올라가지 않더라도 실행이 가능하다는 점에 착안하여 고안되었다.

애플리케이션이 실행될 때, 실행에 필요한 일부분만 메모리에 올라가며 애플리케이션의 나머지는
디스크에 남게된다. 즉, 디스크가 RAM의 보조 기억장치(backing store)처럼 작동하는 것이다.

가상 메모리를 구현하기 위해서는 컴퓨터가 특수 메모리 관리 하드웨어를 갖추고 있어야 한다.
(MMU, Memory Management Unit)

MMU는 가상 주소를 물리주소로 변환하고, 메모리를 보호하는 기능을 수행한다.
MMU를 사용하게 되면, CPU가 각 메모리에 접근하기 이전에 메모리 주소 번역 작업이 수행된다.
그러나 메모리를 일일이 가상 주소에서 물리적 주소로 번역하게 되면 작업 부하가 너무 높아지므로,
MMU는 RAM을 여러부분(페이지, pages)로 나누어 각 페이지를 하나의 독립된 항목으로 처리한다.
페이지 및 주소 번역 정보를 기억하는 작업이 가상 메모리를 구현하는데 있어 결정적인 절차이다.

## 가상 메모리 등장 배경

초창기 컴퓨터에서는 사용 가능한 RAM 용량이 가장 큰 실행 애플리케이션의 주소 공간보다 커야했다.
그렇지 않을 경우 메모리 부족 오류로 인해 해당 애플리케이션을 실행할 수 없다.

이후 컴퓨터에서는 프로그래머가 애플리케이션의 일부만 기억장치에 올려 실행할 수 있도록 지정할 수
있게 하는 오버레이 기법을 사용하여 메모리 부족 문제를 해결하려고 했다. 하지만 이 역시
전반적인 메모리 부족 문제를 해결할 수 없었다. 오버레이를 사용하는 프로그램은 그렇지 않은
프로그램보다는 메모리를 덜 사용했지만, 애초에 시스템이 프로그램을 위한 충분한 메모리를
갖추고 있지 않은 경우 똑같은 메모리 부족 오류가 발생

여기에서 더 발전한 가상 메모리 기법은 애플리케이션을 실행하는데 얼마나 많은 메모리가 필요한지에
집중하지 않고, 대신 애플리케이션을 실행하는데 최소한 ㅇ러마만큼의 메모리가 필요한가에 집중하여
문제를 해결하고자 했다.

이러한 접근 방식이 가능한 이유는 메모리 접근은 순차적이고 지역화되어 있기 때문이다.
애플리케이션의 일부만 메모리에 올리고 메모리에 올라가지 않는 나머지는 보조 기억장치, 디스크에
위치시킨다. 가상 메모리의 핵심은 보조 기억장치이다.

- 물리 메모리 크기에 제약을 받지 않게 된다.
- 더 많은 프로그램을 동시에 실행할 수 있게 된다. 이에 따라 응답시간은 유지되고, CPU 이용률과
  처리율은 높아진다.
- swap에 필요한 입출력이 줄어들기 때문에 프로그램들이 빠르게 실행된다.

## 가상 메모리가 하는 일

가상 메모리는 실제의 물리 메모리 개념과 사용자의 논리 메모리 개념을 분리한 것으로 정리할 수 있다.
이로써 작은 메모리를 가지고도 얼마든지 큰 가상 주소 공간을 프로그래머에게 제공할 수 있다.

## Demand Paging(요구 페이징)

프로그램 실행 시작시에 프로그램 전체를 디스크에서 물리 메모리에 적재하는 대신, 초기에 필요한
것들만 적재하는 전략을 요구 페이징이라고 하며, 가상 메모리 시스템에서 많이 사용된다.
그리고 가상 메모리는 대개 페이지로 관리된다. 요구 페이징을 사용하는 가상 메모리에서는
실행 과정에서 필요해질 때 페이지들이 적재된다. 한 번도 접근되지 않은 페이지는 물리 메모리에
적재되지 않는다.

## Reference

- (가상 메모리)[https://ahnanne.tistory.com/15]
