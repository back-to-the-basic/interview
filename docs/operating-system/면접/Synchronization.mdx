---
title: Synchronization
---

import Image from '@site/src/components/Image';

프로세스 동기화(Process Synchronization)은 여러 프로세스가 공유하는 자원의 일관성을
유지하는 것이다.

여러 프로세스가 서로 협력해 공유자원을 사용하는 상황에서 경쟁 조건(race condition)이 발생하면
공유자원의 신뢰성이 떨어진다.

## Critical Section

Critical Section(임계 구역)은 코드 상에서 Race Condition이 발생할 수 있는 특정 부분을
말한다. Critical Section Problem을 해결하기 위해서는 몇 가지 조건을 충족해야 한다.

- 상호 배제(Mutual Exclusion): 이미 한 프로세스가 임계영역에서 작업중일 때 다른 프로세스는
  임계영역에 진입할 수 없다.
- 진행(Progress): 임계 영역에서 작업중인 프로세스가 없다면 다른 프로세스가 critical section에
  진입할 수 있어야 한다.
- 한정 대기(Bounded Waiting): 임계영역에 진입하려는 프로세스가 무한하게 대기해서는 안된다.

Non-Preemptive Kernels로 구현하면 임계 영역 문제가 발생하지 않는다. 하지만 비선점 스케줄링은 반응성이
떨어지기 때문에 슈퍼컴퓨터가 아니고선 잘 사용하지 않는다.

## Mutex Locks

Mutex Lock은 여러 스레드가 공통 리소스에 접근하는 것을 제어하는 기법으로, lock이 하나만 존재할 수 있는
locking 메커니즘을 따른다.(참고로 Mutex는 MUTual Exclusion을 줄인 말이다.) 이미 하나의 스레드가
critical section에서 작업중인 lock 상태에서 다른 스레드들은 critical section에 진입할 수 없도록 한다.

## Semaphore

세마포어는 여러개의 프로세스나 스레드가 임계영역에 진입할 수 있는 locking 메터니즘이다. 세마포어는 카운터를
이용해 동시에 리소스에 접근할 수 있는 프로세스를 제한한다. 물론 한 프로세스가 값을 변경할 때 다른 프로세스가
동시에 값을 변경하지는 못한다. 세마포어는 P와 V라는 명령으로 접근할 수 있다.(P, V는 try와 increment를
뜻하는 네덜란드어 Proberen과 Verhogen의 머릿글자이다.)

세마포어는 뮤텍스가 될 수 있지만 뮤텍스는 세마포어가 될 수 없다. 세마포어의 카운터가 한 개인 경우 바이너리
세마포어, 두개 이상인 경우 카운팅 세마포어라고 한다. 바이너리 세마포어는 사실상 Mutex와 같다.

## Deadlocks and Starvation

두 프로세스가 서로 종료될 때까지 대기하는 프로그램을 실행한다고 생각해보자. 프로세스 A는 B가 종료될 떄까지,
프로세스 B는 A가 종료될 때까지 작업을 하지 않기 때문에 프로그램은 어떤 동작도 하지 못한다. 이처럼 두 프로세스가
리소스를 점유하고 놓아주지 않거나, 어떠한 프로세스도 리소스를 점유하지 못하는 상태가 되어 프로그램이 멈추는 현상을
데드락(Deadlock)이라고 한다. 운영체제도 결국 소프트웨어이기 때문에 데드락에 빠질 수 있다.

## Reference

- [Synchronization](https://parksb.github.io/article/10.html)
